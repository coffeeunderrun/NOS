// MSR.h - model specific registers.

#ifndef __ARCH_X86_MSR_H__
#define __ARCH_X86_MSR_H__

#include <cstdint>

namespace Kernel
{
	namespace MSR
	{
		const uint32_t MC_ADDR                    = 0x00000000;
		const uint32_t MC_TYPE                    = 0x00000001;
		const uint32_t MONITOR_FILTER_SIZE        = 0x00000006;
		const uint32_t TIME_STAMP_COUNTER         = 0x00000010;
		const uint32_t PLATFORM_ID                = 0x00000017;
		const uint32_t APIC_BASE                  = 0x0000001b;
		const uint32_t EBL_CR_POWERON             = 0x0000002a;
		const uint32_t FEATURE_CONTROL            = 0x0000003a;
		const uint32_t LASTBRANCH_0_FROM_IP       = 0x00000040;
		const uint32_t LASTBRANCH_1_FROM_IP       = 0x00000041;
		const uint32_t LASTBRANCH_2_FROM_IP       = 0x00000042;
		const uint32_t LASTBRANCH_3_FROM_IP       = 0x00000043;
		const uint32_t LASTBRANCH_0_TO_LIP        = 0x00000060;
		const uint32_t LASTBRANCH_1_TO_LIP        = 0x00000061;
		const uint32_t LASTBRANCH_2_TO_LIP        = 0x00000062;
		const uint32_t LASTBRANCH_3_TO_LIP        = 0x00000063;
		const uint32_t BIOS_UPDT_TRIG             = 0x00000079;
		const uint32_t BIOS_SIGN_ID               = 0x0000008b;
		const uint32_t SMM_MONITOR_CTL            = 0x0000009b;
		const uint32_t PMC0                       = 0x000000c1;
		const uint32_t PMC1                       = 0x000000c2;
		const uint32_t PMC2                       = 0x000000c3;
		const uint32_t PMC3                       = 0x000000c4;
		const uint32_t FSB_FREQ                   = 0x000000cd;
		const uint32_t PLATFORM_INFO              = 0x000000ce;
		const uint32_t MPERF                      = 0x000000e7;
		const uint32_t APERF                      = 0x000000e8;
		const uint32_t MTRRCAP                    = 0x000000fe;
		const uint32_t BBL_CR_CTL3                = 0x0000011e;
		const uint32_t SYSENTER_CS                = 0x00000174;
		const uint32_t SYSENTER_ESP               = 0x00000175;
		const uint32_t SYSENTER_EIP               = 0x00000176;
		const uint32_t MCG_CAP                    = 0x00000179;
		const uint32_t MCG_STATUS                 = 0x0000017a;
		const uint32_t MCG_CTL                    = 0x0000017b;
		const uint32_t PERFEVTSEL0                = 0x00000186;
		const uint32_t PERFEVTSEL1                = 0x00000187;
		const uint32_t PERFEVTSEL2                = 0x00000188;
		const uint32_t PERFEVTSEL3                = 0x00000189;
		const uint32_t PERF_STATUS                = 0x00000198;
		const uint32_t PERF_CTL                   = 0x00000199;
		const uint32_t CLOCK_MODULATION           = 0x0000019a;
		const uint32_t THERM_INTERRUPT            = 0x0000019b;
		const uint32_t THERM_STATUS               = 0x0000019c;
		const uint32_t THERM2_CTL                 = 0x0000019d;
		const uint32_t MISC_ENABLE                = 0x000001a0;
		const uint32_t TEMPERATURE_TARGET         = 0x000001a2;
		const uint32_t OFFCORE_RSP0               = 0x000001a6;
		const uint32_t TURBO_RATIO_LIMIT          = 0x000001ad;
		const uint32_t LBR_SELECT                 = 0x000001c8;
		const uint32_t LASTBRANCH_TOS             = 0x000001c9;
		const uint32_t DEBUG_CTL                  = 0x000001d9;
		const uint32_t LER_FROM_LIP               = 0x000001dd;
		const uint32_t LER_TO_LIP                 = 0x000001de;
		const uint32_t PLATFORM_DCA_CAP           = 0x000001f8;
		const uint32_t MTRR_PHYSBASE0             = 0x00000200;
		const uint32_t MTRR_PHYSMASK0             = 0x00000201;
		const uint32_t MTRR_PHYSBASE1             = 0x00000202;
		const uint32_t MTRR_PHYSMASK1             = 0x00000203;
		const uint32_t MTRR_PHYSBASE2             = 0x00000204;
		const uint32_t MTRR_PHYSMASK2             = 0x00000205;
		const uint32_t MTRR_PHYSBASE3             = 0x00000206;
		const uint32_t MTRR_PHYSMASK3             = 0x00000207;
		const uint32_t MTRR_PHYSBASE4             = 0x00000208;
		const uint32_t MTRR_PHYSMASK4             = 0x00000209;
		const uint32_t MTRR_PHYSBASE5             = 0x0000020a;
		const uint32_t MTRR_PHYSMASK5             = 0x0000020b;
		const uint32_t MTRR_PHYSBASE6             = 0x0000020c;
		const uint32_t MTRR_PHYSMASK6             = 0x0000020d;
		const uint32_t MTRR_PHYSBASE7             = 0x0000020e;
		const uint32_t MTRR_PHYSMASK7             = 0x0000020f;
		const uint32_t MTRR_FIX64K_00000          = 0x00000250;
		const uint32_t MTRR_FIX16K_80000          = 0x00000258;
		const uint32_t MTRR_FIX16K_A0000          = 0x00000259;
		const uint32_t MTRR_FIX4K_C0000           = 0x00000268;
		const uint32_t MTRR_FIX4K_C8000           = 0x00000269;
		const uint32_t MTRR_FIX4K_D0000           = 0x0000026a;
		const uint32_t MTRR_FIX4K_D8000           = 0x0000026b;
		const uint32_t MTRR_FIX4K_E0000           = 0x0000026c;
		const uint32_t MTRR_FIX4K_E8000           = 0x0000026d;
		const uint32_t MTRR_FIX4K_F0000           = 0x0000026e;
		const uint32_t MTRR_FIX4K_F8000           = 0x0000026f;
		const uint32_t CR_PAT                     = 0x00000277;
		const uint32_t MC0_CTL2                   = 0x00000280;
		const uint32_t MC1_CTL2                   = 0x00000281;
		const uint32_t MC2_CTL2                   = 0x00000282;
		const uint32_t MC3_CTL2                   = 0x00000283;
		const uint32_t MC4_CTL2                   = 0x00000284;
		const uint32_t MC5_CTL2                   = 0x00000285;
		const uint32_t MC6_CTL2                   = 0x00000286;
		const uint32_t MC7_CTL2                   = 0x00000287;
		const uint32_t MC8_CTL2                   = 0x00000288;
		const uint32_t MTRR_DEF_TYPE              = 0x000002ff;
		const uint32_t FIXED_CTR0                 = 0x00000309;
		const uint32_t FIXED_CTR1                 = 0x0000030a;
		const uint32_t FIXED_CTR2                 = 0x0000030b;
		const uint32_t PERF_CAPABILITIES          = 0x00000345;
		const uint32_t FIXED_CTR_CTL              = 0x0000038d;
		const uint32_t PERF_GLOBAL_STATUS         = 0x0000038e;
		const uint32_t PERF_GLOBAL_CTL            = 0x0000038f;
		const uint32_t PERF_GLOBAL_OVF_CTL        = 0x00000390;
		const uint32_t UNCORE_PERF_GLOBAL_CTL     = 0x00000391;
		const uint32_t UNCORE_PERF_GLOBAL_STATUS  = 0x00000392;
		const uint32_t UNCORE_PERF_GLOBAL_OVF_CTL = 0x00000393;
		const uint32_t UNCORE_FIXED_CTR0          = 0x00000394;
		const uint32_t UNCORE_FIXED_CTR_CTL       = 0x00000395;
		const uint32_t UNCORE_ADDR_OPCODE_MATCH   = 0x00000396;
		const uint32_t UNCORE_PERFEVTSEL0         = 0x000003b0;
		const uint32_t UNCORE_PERFEVTSEL1         = 0x000003b1;
		const uint32_t UNCORE_PERFEVTSEL2         = 0x000003b2;
		const uint32_t UNCORE_PERFEVTSEL3         = 0x000003b3;
		const uint32_t UNCORE_PERFEVTSEL4         = 0x000003b4;
		const uint32_t UNCORE_PERFEVTSEL5         = 0x000003b5;
		const uint32_t UNCORE_PERFEVTSEL6         = 0x000003b6;
		const uint32_t UNCORE_PERFEVTSEL7         = 0x000003b7;
		const uint32_t UNCORE_PMC0                = 0x000003c0;
		const uint32_t UNCORE_PMC1                = 0x000003c1;
		const uint32_t UNCORE_PMC2                = 0x000003c2;
		const uint32_t UNCORE_PMC3                = 0x000003c3;
		const uint32_t UNCORE_PMC4                = 0x000003c4;
		const uint32_t UNCORE_PMC5                = 0x000003c5;
		const uint32_t UNCORE_PMC6                = 0x000003c6;
		const uint32_t UNCORE_PMC7                = 0x000003c7;
		const uint32_t PEBS_ENABLE                = 0x000003f1;
		const uint32_t PEBS_LD_LAT                = 0x000003f6;
		const uint32_t PKG_C3_RESIDENCY           = 0x000003f8;
		const uint32_t PKG_C6_RESIDENCY           = 0x000003f9;
		const uint32_t PKG_C7_RESIDENCY           = 0x000003fa;
		const uint32_t CORE_C3_RESIDENCY          = 0x000003fc;
		const uint32_t CORE_C6_RESIDENCY          = 0x000003fd;
		const uint32_t MC0_CTL                    = 0x00000400;
		const uint32_t MC0_STATUS                 = 0x00000401;
		const uint32_t MC0_ADDR                   = 0x00000402;
		const uint32_t MC0_MISC                   = 0x00000403;
		const uint32_t MC1_CTL                    = 0x00000404;
		const uint32_t MC1_STATUS                 = 0x00000405;
		const uint32_t MC1_ADDR                   = 0x00000406;
		const uint32_t MC1_MISC                   = 0x00000407;
		const uint32_t MC2_CTL                    = 0x00000408;
		const uint32_t MC2_STATUS                 = 0x00000409;
		const uint32_t MC2_ADDR                   = 0x0000040a;
		const uint32_t MC2_MISC                   = 0x0000040b;
		const uint32_t MC3_CTL                    = 0x0000040c;
		const uint32_t MC3_STATUS                 = 0x0000040d;
		const uint32_t MC3_ADDR                   = 0x0000040e;
		const uint32_t MC3_MISC                   = 0x0000040f;
		const uint32_t MC4_CTL                    = 0x00000410;
		const uint32_t MC4_STATUS                 = 0x00000411;
		const uint32_t MC4_ADDR                   = 0x00000412;
		const uint32_t MC4_MISC                   = 0x00000413;
		const uint32_t MC5_CTL                    = 0x00000414;
		const uint32_t MC5_STATUS                 = 0x00000415;
		const uint32_t MC5_ADDR                   = 0x00000416;
		const uint32_t MC5_MISC                   = 0x00000417;
		const uint32_t MC6_STATUS                 = 0x00000419;
		const uint32_t MC7_STATUS                 = 0x0000041d;
		const uint32_t MC8_STATUS                 = 0x00000421;
		const uint32_t VMX_BASIC                  = 0x00000480;
		const uint32_t VMX_PINBASED_CTLS          = 0x00000481;
		const uint32_t VMX_PROCBASED_CTLS         = 0x00000482;
		const uint32_t VMX_EXIT_CTLS              = 0x00000483;
		const uint32_t VMX_ENTRY_CTLS             = 0x00000484;
		const uint32_t VMX_MISC_CTLS              = 0x00000485;
		const uint32_t VMX_CR0_FIXED0             = 0x00000486;
		const uint32_t VMX_CR0_FIXED1             = 0x00000487;
		const uint32_t VMX_CR4_FIXED0             = 0x00000488;
		const uint32_t VMX_CR4_FIXED1             = 0x00000489;
		const uint32_t VMX_VMCS_ENUM              = 0x0000048a;
		const uint32_t VMX_PROCBASED_CTLS2        = 0x0000048b;
		const uint32_t VMX_EPT_VPID_CAP           = 0x0000048c;
		const uint32_t VMX_TRUE_PINBASES_CTLS     = 0x0000048d;
		const uint32_t VMX_TRUE_PROCBASED_CTLS    = 0x0000048e;
		const uint32_t VMX_TRUE_EXIT_CTLS         = 0x0000048f;
		const uint32_t VMX_TRUE_ENTRY_CTLS        = 0x00000490;
		const uint32_t DS_AREA                    = 0x00000600;
		const uint32_t EXT_XAPICID                = 0x00000802;
		const uint32_t EXT_XAPIC_VERSION          = 0x00000803;
		const uint32_t EXT_XAPIC_TPR              = 0x00000808;
		const uint32_t EXT_XAPIC_PPR              = 0x0000080a;
		const uint32_t EXT_XAPIC_EOI              = 0x0000080b;
		const uint32_t EXT_XAPIC_LDR              = 0x0000080d;
		const uint32_t EXT_XAPIC_SIVR             = 0x0000080f;
		const uint32_t EXT_XAPIC_ISR0             = 0x00000810;
		const uint32_t EXT_XAPIC_ISR1             = 0x00000811;
		const uint32_t EXT_XAPIC_ISR2             = 0x00000812;
		const uint32_t EXT_XAPIC_ISR3             = 0x00000813;
		const uint32_t EXT_XAPIC_ISR4             = 0x00000814;
		const uint32_t EXT_XAPIC_ISR5             = 0x00000815;
		const uint32_t EXT_XAPIC_ISR6             = 0x00000816;
		const uint32_t EXT_XAPIC_ISR7             = 0x00000817;
		const uint32_t EXT_XAPIC_TMR0             = 0x00000818;
		const uint32_t EXT_XAPIC_TMR1             = 0x00000819;
		const uint32_t EXT_XAPIC_TMR2             = 0x0000081a;
		const uint32_t EXT_XAPIC_TMR3             = 0x0000081b;
		const uint32_t EXT_XAPIC_TMR4             = 0x0000081c;
		const uint32_t EXT_XAPIC_TMR5             = 0x0000081d;
		const uint32_t EXT_XAPIC_TMR6             = 0x0000081e;
		const uint32_t EXT_XAPIC_TMR7             = 0x0000081f;
		const uint32_t EXT_XAPIC_IRR0             = 0x00000820;
		const uint32_t EXT_XAPIC_IRR1             = 0x00000821;
		const uint32_t EXT_XAPIC_IRR2             = 0x00000822;
		const uint32_t EXT_XAPIC_IRR3             = 0x00000823;
		const uint32_t EXT_XAPIC_IRR4             = 0x00000824;
		const uint32_t EXT_XAPIC_IRR5             = 0x00000825;
		const uint32_t EXT_XAPIC_IRR6             = 0x00000826;
		const uint32_t EXT_XAPIC_IRR7             = 0x00000827;
		const uint32_t EXT_XAPIC_ESR              = 0x00000828;
		const uint32_t EXT_XAPIC_CMCI             = 0x0000082f;
		const uint32_t EXT_XAPIC_ICR              = 0x00000830;
		const uint32_t EXT_XAPIC_LVT_TIMER        = 0x00000832;
		const uint32_t EXT_XAPIC_LVT_THERMAL      = 0x00000833;
		const uint32_t EXT_XAPIC_LVT_PMI          = 0x00000834;
		const uint32_t EXT_XAPIC_LVT_LINT0        = 0x00000835;
		const uint32_t EXT_XAPIC_LVT_LINT1        = 0x00000836;
		const uint32_t EXT_XAPIC_LVT_ERROR        = 0x00000837;
		const uint32_t EXT_XAPIC_INIT_COUNT       = 0x00000838;
		const uint32_t EXT_XAPIC_CUR_COUNT        = 0x00000839;
		const uint32_t EXT_XAPIC_DIV_CONF         = 0x0000083e;
		const uint32_t EXT_XAPIC_SELF_IPI         = 0x0000083f;
		const uint32_t EMON_L3_CTR_CTL0           = 0x000107cc;
		const uint32_t EMON_L3_CTR_CTL1           = 0x000107cd;
		const uint32_t EMON_L3_CTR_CTL2           = 0x000107ce;
		const uint32_t EMON_L3_CTR_CTL3           = 0x000107cf;
		const uint32_t EMON_L3_CTR_CTL4           = 0x000107d0;
		const uint32_t EMON_L3_CTR_CTL5           = 0x000107d1;
		const uint32_t EMON_L3_CTR_CTL6           = 0x000107d2;
		const uint32_t EMON_L3_CTR_CTL7           = 0x000107d3;
		const uint32_t EMON_L3_GL_CTL             = 0x000107d8;
		const uint32_t EFER                       = 0xc0000080;
		const uint32_t STAR                       = 0xc0000081;
		const uint32_t LSTAR                      = 0xc0000082;
		const uint32_t FMASK                      = 0xc0000083;
		const uint32_t FS_BASE                    = 0xc0000100;
		const uint32_t GS_BASE                    = 0xc0000101;
		const uint32_t KERNEL_GS_BASE             = 0xc0000102;
		const uint32_t TSC_AUX                    = 0xc0000103;

		inline uint64_t Read(uint32_t msr)
		{
			uint32_t high, low;

			asm volatile ("rdmsr" : "=a"(low), "=d"(high) : "c"(msr));
			return((((uint64_t)high) << 32) + (uint64_t)low);
		}

		inline void Write(uint32_t msr, uint64_t value)
		{
			asm volatile ("wrmsr" : : "a"((uint32_t)value), "d"((uint32_t)(value >> 32)), "c"(msr));
		}
	}
}

#endif
